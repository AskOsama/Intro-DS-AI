<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 850 380">
  <defs>
    <style>
      .title { font-family: Arial, sans-serif; font-size: 18px; font-weight: bold; fill: #2c3e50; }
      .phase-title { font-family: Arial, sans-serif; font-size: 14px; font-weight: bold; fill: #fff; }
      .box-label { font-family: Arial, sans-serif; font-size: 11px; font-weight: bold; fill: #2c3e50; }
      .data-label { font-family: Arial, sans-serif; font-size: 9px; fill: #34495e; }
      .small-label { font-family: Arial, sans-serif; font-size: 8px; fill: #7f8c8d; }
    </style>
    <marker id="arrow" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <polygon points="0 0, 8 3, 0 6" fill="#95a5a6"/>
    </marker>
  </defs>

  <!-- Title -->
  <text x="425" y="25" text-anchor="middle" class="title">MapReduce Execution Flow: Word Count Example</text>

  <!-- Phase Headers -->
  <!-- Input -->
  <rect x="20" y="45" width="80" height="30" rx="5" fill="#34495e"/>
  <text x="60" y="65" text-anchor="middle" class="phase-title">Input</text>

  <!-- Split -->
  <rect x="120" y="45" width="80" height="30" rx="5" fill="#9b59b6"/>
  <text x="160" y="65" text-anchor="middle" class="phase-title">Split</text>

  <!-- Map -->
  <rect x="270" y="45" width="100" height="30" rx="5" fill="#3498db"/>
  <text x="320" y="65" text-anchor="middle" class="phase-title">Map</text>

  <!-- Shuffle -->
  <rect x="450" y="45" width="100" height="30" rx="5" fill="#e67e22"/>
  <text x="500" y="65" text-anchor="middle" class="phase-title">Shuffle</text>

  <!-- Reduce -->
  <rect x="620" y="45" width="100" height="30" rx="5" fill="#27ae60"/>
  <text x="670" y="65" text-anchor="middle" class="phase-title">Reduce</text>

  <!-- Output -->
  <rect x="760" y="45" width="70" height="30" rx="5" fill="#2c3e50"/>
  <text x="795" y="65" text-anchor="middle" class="phase-title">Output</text>

  <!-- INPUT DATA -->
  <rect x="20" y="95" width="80" height="200" rx="5" fill="#ecf0f1" stroke="#bdc3c7" stroke-width="2"/>
  <text x="60" y="115" text-anchor="middle" class="box-label">Document</text>
  <text x="60" y="140" text-anchor="middle" class="data-label">"Hello World</text>
  <text x="60" y="155" text-anchor="middle" class="data-label">Hello Data</text>
  <text x="60" y="170" text-anchor="middle" class="data-label">World Data</text>
  <text x="60" y="185" text-anchor="middle" class="data-label">Big Data</text>
  <text x="60" y="200" text-anchor="middle" class="data-label">Hello Big"</text>

  <!-- Arrow to Split -->
  <line x1="100" y1="195" x2="118" y2="195" stroke="#95a5a6" stroke-width="2" marker-end="url(#arrow)"/>

  <!-- SPLIT PHASE -->
  <g transform="translate(120, 95)">
    <rect x="0" y="0" width="80" height="55" rx="3" fill="#f5eef8" stroke="#9b59b6"/>
    <text x="40" y="15" text-anchor="middle" class="box-label">Chunk 1</text>
    <text x="40" y="32" text-anchor="middle" class="data-label">"Hello World</text>
    <text x="40" y="45" text-anchor="middle" class="data-label">Hello Data"</text>
  </g>
  <g transform="translate(120, 160)">
    <rect x="0" y="0" width="80" height="55" rx="3" fill="#f5eef8" stroke="#9b59b6"/>
    <text x="40" y="15" text-anchor="middle" class="box-label">Chunk 2</text>
    <text x="40" y="32" text-anchor="middle" class="data-label">"World Data</text>
    <text x="40" y="45" text-anchor="middle" class="data-label">Big Data"</text>
  </g>
  <g transform="translate(120, 225)">
    <rect x="0" y="0" width="80" height="55" rx="3" fill="#f5eef8" stroke="#9b59b6"/>
    <text x="40" y="15" text-anchor="middle" class="box-label">Chunk 3</text>
    <text x="40" y="32" text-anchor="middle" class="data-label">"Hello Big"</text>
  </g>

  <!-- Arrows to Map -->
  <line x1="200" y1="122" x2="268" y2="122" stroke="#95a5a6" stroke-width="2" marker-end="url(#arrow)"/>
  <line x1="200" y1="187" x2="268" y2="187" stroke="#95a5a6" stroke-width="2" marker-end="url(#arrow)"/>
  <line x1="200" y1="252" x2="268" y2="252" stroke="#95a5a6" stroke-width="2" marker-end="url(#arrow)"/>

  <!-- MAP PHASE -->
  <g transform="translate(270, 95)">
    <rect x="0" y="0" width="100" height="55" rx="3" fill="#ebf5fb" stroke="#3498db"/>
    <text x="50" y="15" text-anchor="middle" class="box-label">Mapper 1</text>
    <text x="50" y="30" text-anchor="middle" class="data-label">(Hello,1) (World,1)</text>
    <text x="50" y="43" text-anchor="middle" class="data-label">(Hello,1) (Data,1)</text>
  </g>
  <g transform="translate(270, 160)">
    <rect x="0" y="0" width="100" height="55" rx="3" fill="#ebf5fb" stroke="#3498db"/>
    <text x="50" y="15" text-anchor="middle" class="box-label">Mapper 2</text>
    <text x="50" y="30" text-anchor="middle" class="data-label">(World,1) (Data,1)</text>
    <text x="50" y="43" text-anchor="middle" class="data-label">(Big,1) (Data,1)</text>
  </g>
  <g transform="translate(270, 225)">
    <rect x="0" y="0" width="100" height="55" rx="3" fill="#ebf5fb" stroke="#3498db"/>
    <text x="50" y="15" text-anchor="middle" class="box-label">Mapper 3</text>
    <text x="50" y="30" text-anchor="middle" class="data-label">(Hello,1) (Big,1)</text>
  </g>

  <!-- Arrows to Shuffle (converging) -->
  <line x1="370" y1="122" x2="448" y2="160" stroke="#95a5a6" stroke-width="2" marker-end="url(#arrow)"/>
  <line x1="370" y1="187" x2="448" y2="187" stroke="#95a5a6" stroke-width="2" marker-end="url(#arrow)"/>
  <line x1="370" y1="252" x2="448" y2="220" stroke="#95a5a6" stroke-width="2" marker-end="url(#arrow)"/>

  <!-- SHUFFLE PHASE -->
  <g transform="translate(450, 95)">
    <rect x="0" y="0" width="100" height="180" rx="3" fill="#fef5e7" stroke="#e67e22"/>
    <text x="50" y="18" text-anchor="middle" class="box-label">Group by Key</text>
    <line x1="10" y1="25" x2="90" y2="25" stroke="#e67e22" stroke-width="1"/>
    <text x="50" y="45" text-anchor="middle" class="data-label">Hello: [1,1,1]</text>
    <text x="50" y="70" text-anchor="middle" class="data-label">World: [1,1]</text>
    <text x="50" y="95" text-anchor="middle" class="data-label">Data: [1,1,1]</text>
    <text x="50" y="120" text-anchor="middle" class="data-label">Big: [1,1]</text>
    <text x="50" y="160" text-anchor="middle" class="small-label">Sorted &amp; Grouped</text>
  </g>

  <!-- Arrows to Reduce -->
  <line x1="550" y1="140" x2="618" y2="122" stroke="#95a5a6" stroke-width="2" marker-end="url(#arrow)"/>
  <line x1="550" y1="165" x2="618" y2="165" stroke="#95a5a6" stroke-width="2" marker-end="url(#arrow)"/>
  <line x1="550" y1="190" x2="618" y2="208" stroke="#95a5a6" stroke-width="2" marker-end="url(#arrow)"/>
  <line x1="550" y1="215" x2="618" y2="251" stroke="#95a5a6" stroke-width="2" marker-end="url(#arrow)"/>

  <!-- REDUCE PHASE -->
  <g transform="translate(620, 95)">
    <rect x="0" y="0" width="100" height="40" rx="3" fill="#e8f8f5" stroke="#27ae60"/>
    <text x="50" y="15" text-anchor="middle" class="box-label">Reducer</text>
    <text x="50" y="32" text-anchor="middle" class="data-label">sum([1,1,1])=3</text>
  </g>
  <g transform="translate(620, 145)">
    <rect x="0" y="0" width="100" height="40" rx="3" fill="#e8f8f5" stroke="#27ae60"/>
    <text x="50" y="15" text-anchor="middle" class="box-label">Reducer</text>
    <text x="50" y="32" text-anchor="middle" class="data-label">sum([1,1])=2</text>
  </g>
  <g transform="translate(620, 195)">
    <rect x="0" y="0" width="100" height="40" rx="3" fill="#e8f8f5" stroke="#27ae60"/>
    <text x="50" y="15" text-anchor="middle" class="box-label">Reducer</text>
    <text x="50" y="32" text-anchor="middle" class="data-label">sum([1,1,1])=3</text>
  </g>
  <g transform="translate(620, 245)">
    <rect x="0" y="0" width="100" height="40" rx="3" fill="#e8f8f5" stroke="#27ae60"/>
    <text x="50" y="15" text-anchor="middle" class="box-label">Reducer</text>
    <text x="50" y="32" text-anchor="middle" class="data-label">sum([1,1])=2</text>
  </g>

  <!-- Arrows to Output -->
  <line x1="720" y1="115" x2="758" y2="150" stroke="#95a5a6" stroke-width="2" marker-end="url(#arrow)"/>
  <line x1="720" y1="165" x2="758" y2="175" stroke="#95a5a6" stroke-width="2" marker-end="url(#arrow)"/>
  <line x1="720" y1="215" x2="758" y2="200" stroke="#95a5a6" stroke-width="2" marker-end="url(#arrow)"/>
  <line x1="720" y1="265" x2="758" y2="225" stroke="#95a5a6" stroke-width="2" marker-end="url(#arrow)"/>

  <!-- OUTPUT -->
  <rect x="760" y="120" width="70" height="130" rx="5" fill="#2c3e50"/>
  <text x="795" y="145" text-anchor="middle" class="phase-title" style="font-size: 11px;">Results</text>
  <text x="795" y="170" text-anchor="middle" class="data-label" style="fill: #ecf0f1;">Hello: 3</text>
  <text x="795" y="190" text-anchor="middle" class="data-label" style="fill: #ecf0f1;">World: 2</text>
  <text x="795" y="210" text-anchor="middle" class="data-label" style="fill: #ecf0f1;">Data: 3</text>
  <text x="795" y="230" text-anchor="middle" class="data-label" style="fill: #ecf0f1;">Big: 2</text>

  <!-- Legend -->
  <rect x="20" y="320" width="810" height="50" rx="5" fill="#f8f9fa" stroke="#dee2e6"/>
  <text x="40" y="345" class="box-label">Legend:</text>
  <rect x="110" y="332" width="20" height="15" fill="#9b59b6"/>
  <text x="135" y="344" class="small-label">Split: Divide data into chunks</text>
  <rect x="280" y="332" width="20" height="15" fill="#3498db"/>
  <text x="305" y="344" class="small-label">Map: Process each chunk</text>
  <rect x="450" y="332" width="20" height="15" fill="#e67e22"/>
  <text x="475" y="344" class="small-label">Shuffle: Group by key</text>
  <rect x="620" y="332" width="20" height="15" fill="#27ae60"/>
  <text x="645" y="344" class="small-label">Reduce: Aggregate results</text>

</svg>
