<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 850 380">
  <defs>
    <style>
      .title { font-family: 'Cairo', Arial, sans-serif; font-size: 18px; font-weight: bold; fill: #2c3e50; direction: rtl; }
      .phase-title { font-family: 'Cairo', Arial, sans-serif; font-size: 14px; font-weight: bold; fill: #fff; direction: rtl; }
      .box-label { font-family: 'Cairo', Arial, sans-serif; font-size: 11px; font-weight: bold; fill: #2c3e50; direction: rtl; }
      .data-label { font-family: Arial, sans-serif; font-size: 9px; fill: #34495e; }
      .data-label-ar { font-family: 'Cairo', Arial, sans-serif; font-size: 9px; fill: #34495e; direction: rtl; }
      .small-label { font-family: 'Cairo', Arial, sans-serif; font-size: 8px; fill: #7f8c8d; direction: rtl; }
    </style>
    <marker id="arrow" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <polygon points="0 0, 8 3, 0 6" fill="#95a5a6"/>
    </marker>
    <marker id="arrow-rtl" markerWidth="8" markerHeight="6" refX="0" refY="3" orient="auto">
      <polygon points="8 0, 0 3, 8 6" fill="#95a5a6"/>
    </marker>
  </defs>

  <!-- Title -->
  <text x="425" y="25" text-anchor="middle" class="title">تدفق تنفيذ MapReduce: مثال عد الكلمات</text>

  <!-- Phase Headers (RTL order) -->
  <!-- Output -->
  <rect x="20" y="45" width="70" height="30" rx="5" fill="#2c3e50"/>
  <text x="55" y="65" text-anchor="middle" class="phase-title">المخرج</text>

  <!-- Reduce -->
  <rect x="110" y="45" width="100" height="30" rx="5" fill="#27ae60"/>
  <text x="160" y="65" text-anchor="middle" class="phase-title">الاختزال</text>

  <!-- Shuffle -->
  <rect x="280" y="45" width="100" height="30" rx="5" fill="#e67e22"/>
  <text x="330" y="65" text-anchor="middle" class="phase-title">الخلط</text>

  <!-- Map -->
  <rect x="460" y="45" width="100" height="30" rx="5" fill="#3498db"/>
  <text x="510" y="65" text-anchor="middle" class="phase-title">التعيين</text>

  <!-- Split -->
  <rect x="630" y="45" width="80" height="30" rx="5" fill="#9b59b6"/>
  <text x="670" y="65" text-anchor="middle" class="phase-title">التقسيم</text>

  <!-- Input -->
  <rect x="750" y="45" width="80" height="30" rx="5" fill="#34495e"/>
  <text x="790" y="65" text-anchor="middle" class="phase-title">المدخل</text>

  <!-- INPUT DATA (Right side for RTL) -->
  <rect x="750" y="95" width="80" height="200" rx="5" fill="#ecf0f1" stroke="#bdc3c7" stroke-width="2"/>
  <text x="790" y="115" text-anchor="middle" class="box-label">المستند</text>
  <text x="790" y="140" text-anchor="middle" class="data-label">"Hello World</text>
  <text x="790" y="155" text-anchor="middle" class="data-label">Hello Data</text>
  <text x="790" y="170" text-anchor="middle" class="data-label">World Data</text>
  <text x="790" y="185" text-anchor="middle" class="data-label">Big Data</text>
  <text x="790" y="200" text-anchor="middle" class="data-label">Hello Big"</text>

  <!-- Arrow to Split -->
  <line x1="750" y1="195" x2="712" y2="195" stroke="#95a5a6" stroke-width="2" marker-end="url(#arrow-rtl)"/>

  <!-- SPLIT PHASE -->
  <g transform="translate(630, 95)">
    <rect x="0" y="0" width="80" height="55" rx="3" fill="#f5eef8" stroke="#9b59b6"/>
    <text x="40" y="15" text-anchor="middle" class="box-label">جزء ١</text>
    <text x="40" y="32" text-anchor="middle" class="data-label">"Hello World</text>
    <text x="40" y="45" text-anchor="middle" class="data-label">Hello Data"</text>
  </g>
  <g transform="translate(630, 160)">
    <rect x="0" y="0" width="80" height="55" rx="3" fill="#f5eef8" stroke="#9b59b6"/>
    <text x="40" y="15" text-anchor="middle" class="box-label">جزء ٢</text>
    <text x="40" y="32" text-anchor="middle" class="data-label">"World Data</text>
    <text x="40" y="45" text-anchor="middle" class="data-label">Big Data"</text>
  </g>
  <g transform="translate(630, 225)">
    <rect x="0" y="0" width="80" height="55" rx="3" fill="#f5eef8" stroke="#9b59b6"/>
    <text x="40" y="15" text-anchor="middle" class="box-label">جزء ٣</text>
    <text x="40" y="32" text-anchor="middle" class="data-label">"Hello Big"</text>
  </g>

  <!-- Arrows to Map -->
  <line x1="630" y1="122" x2="562" y2="122" stroke="#95a5a6" stroke-width="2" marker-end="url(#arrow-rtl)"/>
  <line x1="630" y1="187" x2="562" y2="187" stroke="#95a5a6" stroke-width="2" marker-end="url(#arrow-rtl)"/>
  <line x1="630" y1="252" x2="562" y2="252" stroke="#95a5a6" stroke-width="2" marker-end="url(#arrow-rtl)"/>

  <!-- MAP PHASE -->
  <g transform="translate(460, 95)">
    <rect x="0" y="0" width="100" height="55" rx="3" fill="#ebf5fb" stroke="#3498db"/>
    <text x="50" y="15" text-anchor="middle" class="box-label">معيّن ١</text>
    <text x="50" y="30" text-anchor="middle" class="data-label">(Hello,1) (World,1)</text>
    <text x="50" y="43" text-anchor="middle" class="data-label">(Hello,1) (Data,1)</text>
  </g>
  <g transform="translate(460, 160)">
    <rect x="0" y="0" width="100" height="55" rx="3" fill="#ebf5fb" stroke="#3498db"/>
    <text x="50" y="15" text-anchor="middle" class="box-label">معيّن ٢</text>
    <text x="50" y="30" text-anchor="middle" class="data-label">(World,1) (Data,1)</text>
    <text x="50" y="43" text-anchor="middle" class="data-label">(Big,1) (Data,1)</text>
  </g>
  <g transform="translate(460, 225)">
    <rect x="0" y="0" width="100" height="55" rx="3" fill="#ebf5fb" stroke="#3498db"/>
    <text x="50" y="15" text-anchor="middle" class="box-label">معيّن ٣</text>
    <text x="50" y="30" text-anchor="middle" class="data-label">(Hello,1) (Big,1)</text>
  </g>

  <!-- Arrows to Shuffle -->
  <line x1="460" y1="122" x2="382" y2="160" stroke="#95a5a6" stroke-width="2" marker-end="url(#arrow-rtl)"/>
  <line x1="460" y1="187" x2="382" y2="187" stroke="#95a5a6" stroke-width="2" marker-end="url(#arrow-rtl)"/>
  <line x1="460" y1="252" x2="382" y2="220" stroke="#95a5a6" stroke-width="2" marker-end="url(#arrow-rtl)"/>

  <!-- SHUFFLE PHASE -->
  <g transform="translate(280, 95)">
    <rect x="0" y="0" width="100" height="180" rx="3" fill="#fef5e7" stroke="#e67e22"/>
    <text x="50" y="18" text-anchor="middle" class="box-label">تجميع بالمفتاح</text>
    <line x1="10" y1="25" x2="90" y2="25" stroke="#e67e22" stroke-width="1"/>
    <text x="50" y="45" text-anchor="middle" class="data-label">Hello: [1,1,1]</text>
    <text x="50" y="70" text-anchor="middle" class="data-label">World: [1,1]</text>
    <text x="50" y="95" text-anchor="middle" class="data-label">Data: [1,1,1]</text>
    <text x="50" y="120" text-anchor="middle" class="data-label">Big: [1,1]</text>
    <text x="50" y="160" text-anchor="middle" class="small-label">مرتب ومجمّع</text>
  </g>

  <!-- Arrows to Reduce -->
  <line x1="280" y1="140" x2="212" y2="122" stroke="#95a5a6" stroke-width="2" marker-end="url(#arrow-rtl)"/>
  <line x1="280" y1="165" x2="212" y2="165" stroke="#95a5a6" stroke-width="2" marker-end="url(#arrow-rtl)"/>
  <line x1="280" y1="190" x2="212" y2="208" stroke="#95a5a6" stroke-width="2" marker-end="url(#arrow-rtl)"/>
  <line x1="280" y1="215" x2="212" y2="251" stroke="#95a5a6" stroke-width="2" marker-end="url(#arrow-rtl)"/>

  <!-- REDUCE PHASE -->
  <g transform="translate(110, 95)">
    <rect x="0" y="0" width="100" height="40" rx="3" fill="#e8f8f5" stroke="#27ae60"/>
    <text x="50" y="15" text-anchor="middle" class="box-label">مختزل</text>
    <text x="50" y="32" text-anchor="middle" class="data-label">sum([1,1,1])=3</text>
  </g>
  <g transform="translate(110, 145)">
    <rect x="0" y="0" width="100" height="40" rx="3" fill="#e8f8f5" stroke="#27ae60"/>
    <text x="50" y="15" text-anchor="middle" class="box-label">مختزل</text>
    <text x="50" y="32" text-anchor="middle" class="data-label">sum([1,1])=2</text>
  </g>
  <g transform="translate(110, 195)">
    <rect x="0" y="0" width="100" height="40" rx="3" fill="#e8f8f5" stroke="#27ae60"/>
    <text x="50" y="15" text-anchor="middle" class="box-label">مختزل</text>
    <text x="50" y="32" text-anchor="middle" class="data-label">sum([1,1,1])=3</text>
  </g>
  <g transform="translate(110, 245)">
    <rect x="0" y="0" width="100" height="40" rx="3" fill="#e8f8f5" stroke="#27ae60"/>
    <text x="50" y="15" text-anchor="middle" class="box-label">مختزل</text>
    <text x="50" y="32" text-anchor="middle" class="data-label">sum([1,1])=2</text>
  </g>

  <!-- Arrows to Output -->
  <line x1="110" y1="115" x2="92" y2="150" stroke="#95a5a6" stroke-width="2" marker-end="url(#arrow-rtl)"/>
  <line x1="110" y1="165" x2="92" y2="175" stroke="#95a5a6" stroke-width="2" marker-end="url(#arrow-rtl)"/>
  <line x1="110" y1="215" x2="92" y2="200" stroke="#95a5a6" stroke-width="2" marker-end="url(#arrow-rtl)"/>
  <line x1="110" y1="265" x2="92" y2="225" stroke="#95a5a6" stroke-width="2" marker-end="url(#arrow-rtl)"/>

  <!-- OUTPUT -->
  <rect x="20" y="120" width="70" height="130" rx="5" fill="#2c3e50"/>
  <text x="55" y="145" text-anchor="middle" class="phase-title" style="font-size: 11px;">النتائج</text>
  <text x="55" y="170" text-anchor="middle" class="data-label" style="fill: #ecf0f1;">Hello: 3</text>
  <text x="55" y="190" text-anchor="middle" class="data-label" style="fill: #ecf0f1;">World: 2</text>
  <text x="55" y="210" text-anchor="middle" class="data-label" style="fill: #ecf0f1;">Data: 3</text>
  <text x="55" y="230" text-anchor="middle" class="data-label" style="fill: #ecf0f1;">Big: 2</text>

  <!-- Legend -->
  <rect x="20" y="320" width="810" height="50" rx="5" fill="#f8f9fa" stroke="#dee2e6"/>
  <text x="780" y="345" text-anchor="end" class="box-label">المفتاح:</text>
  <rect x="700" y="332" width="20" height="15" fill="#9b59b6"/>
  <text x="695" y="344" text-anchor="end" class="small-label">التقسيم: تجزئة البيانات</text>
  <rect x="530" y="332" width="20" height="15" fill="#3498db"/>
  <text x="525" y="344" text-anchor="end" class="small-label">التعيين: معالجة كل جزء</text>
  <rect x="360" y="332" width="20" height="15" fill="#e67e22"/>
  <text x="355" y="344" text-anchor="end" class="small-label">الخلط: تجميع بالمفتاح</text>
  <rect x="190" y="332" width="20" height="15" fill="#27ae60"/>
  <text x="185" y="344" text-anchor="end" class="small-label">الاختزال: تجميع النتائج</text>

</svg>
